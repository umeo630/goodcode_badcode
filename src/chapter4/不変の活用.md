## 不変の活用
### 再代入
   - 変数の意味が変わり、推測を困難にする
   - いつ変更されたのか追うのが難しい
 - 再代入を防ぐ
   - `final`を使う
   - ローカル変数、メソッド引数に付与することでメソッド内での再代入を防ぐ
   - 変更したい場合は別の不変の変数を用意する
### 可変がもたらす影響
- 可変インスタンスの使い回し
   - 予期せぬ動作を招きやすくなる
- 関数による可変インスタンスの操作
  - 副作用により別スレッドでインスタンスの状態が変更される可能性がある
- 副作用のデメリット
  - 主作用
    - メソッドが引数を受け取り、値を返すこと
  - 副作用
    - 主作用以外に状態変更すること
      - インスタンス変数の変更
      - グローバル変数の変更
      - 引数の変更
      - ファイルの読み書きなどのI/O操作
  - 同じ結果を得るためには処理の実行順に依存する
- 関数の影響範囲を限定する
  - 関数が以下を満たすように設計する
    - データ、つまり状態を引数で受け取る
    - 状態を変更しない
    - 値は関数の戻り値として返す
- 不変にして予期せぬ動作を防ぐ
  - インスタンス変数、メソッドの引数を不変に
  - 変更する場合は新しいインスタンスを生成する
### 不変と可変の取扱方針
- デフォルトは不変
  - 多少冗長になっても不変のメリットの方が大きい
- 可変にして良い場合
  - 不変だとパフォーマンス要件を満たせない場合
  - スコープが局所的な場合
    - ループカウンタなど
- 可変にする場合、正しい状態変更のみ発生させるよう設計する
- コード外とのやりとりは局所化する
  - I/O操作やDB操作はコードの外の状態に依存する
  - リポジトリパターンなど